<div class="class-panel">
  <select [ngModel]="activeClassId" (ngModelChange)="store.setActiveClassById($event)">
    <option *ngFor="let c of classes" [value]="c.classId">{{c.title}}</option>
  </select>

  <button (click)="openCreateClassDialog()" [disabled]="!activeClass || !editMode.isEnabled">New Class</button>
  <button (click)="renameActiveClass()" [disabled]="!activeClass || !editMode.isEnabled">Rename</button>
  <button (click)="deleteActiveClass()" [disabled]="!activeClass || !editMode.isEnabled">Delete</button>
  <button (click)="openCriteriaEditor()" [disabled]="!activeClass || !editMode.isEnabled">Edit Criteria</button>
  <button (click)="toggleDataMenu()" [disabled]="!activeClass">Data</button>
    <button (click)="openChart()" [disabled]="!activeClass">Trend</button>
  <div *ngIf="showChart" class="chart-dialog" (click)="closeChart()">
    <div class="dialog-content" (click)="$event.stopPropagation()">
      <!-- Selection UI -->
      <div *ngIf="!selectedCriterion" class="criterion-select">
        <p>Choose criterion:</p>
        <button *ngFor="let c of numericCriteria" (click)="chooseCriterion(c.name)">{{c.name}}</button>
      </div>
      <!-- Chart canvas shown after selection -->
      <canvas *ngIf="selectedCriterion" #chartCanvas width="600" height="400"></canvas>
    </div>
  </div>
  <div *ngIf="showDataMenu" class="data-overlay" (click)="closeDataMenu()">
    <div class="data-menu" (click)="$event.stopPropagation()">
      <button (click)="exportClass(); closeDataMenu()">Export Class</button>
      <button (click)="exportCsv(); closeDataMenu()">Export CSV</button>
      <button (click)="exportStudentCollatedCsv(); closeDataMenu()">Export Student Collated CSV</button>
      <button (click)="triggerImport(); closeDataMenu()" [disabled]="!editMode.isEnabled">Import Classes</button>
    </div>
  </div>
    <criteria-editor *ngIf="showCriteriaEditor"
      [criteria]="displayedCriteria"
      (save)="onCriteriaSaved($event)"
      (cancel)="onCriteriaCancel()">
    </criteria-editor>
  <input type="file" #fileInput style="display:none" (change)="importClasses($event)" />
  <!-- Edit mode toggle moved to topâ€‘right corner in app.html -->

</div>
